<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Admin Panel - APIP STORE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background: #020617; color: white; font-family: 'Poppins', sans-serif; }
        .tab-content { display: none; }
        .tab-active { display: block; }
        .active-btn { background: #3b82f6; }
    </style>
</head>
<body class="flex flex-col md:flex-row min-h-screen">
    <aside class="w-64 border-r border-white/5 p-6 space-y-4">
        <h1 class="text-blue-500 font-black text-xl mb-10">ADMIN APIP</h1>
        <button onclick="tab('prod')" id="b-prod" class="w-full text-left p-3 rounded-lg active-btn">Produk</button>
        <button onclick="tab('inv')" id="b-inv" class="w-full text-left p-3 rounded-lg">Transaksi</button>
        <button onclick="tab('mem')" id="b-mem" class="w-full text-left p-3 rounded-lg">Member</button>
    </aside>

    <main class="flex-1 p-10">
        <div id="tab-prod" class="tab-content tab-active">
            <h2 class="text-2xl font-bold mb-6">Kelola Produk</h2>
            <form id="pForm" class="grid grid-cols-4 gap-4 mb-8">
                <input type="hidden" id="editIdx">
                <input type="text" id="pGame" placeholder="Game" class="bg-slate-900 border border-white/10 p-3 rounded-lg" required>
                <input type="text" id="pNama" placeholder="Nama Item" class="bg-slate-900 border border-white/10 p-3 rounded-lg" required>
                <input type="number" id="pHarga" placeholder="Harga" class="bg-slate-900 border border-white/10 p-3 rounded-lg" required>
                <button class="bg-blue-600 font-bold rounded-lg">Simpan</button>
            </form>
            <table class="w-full text-left border-collapse">
                <thead class="bg-white/5 uppercase text-xs">
                    <tr><th class="p-4">Game</th><th class="p-4">Item</th><th class="p-4">Harga</th><th class="p-4 text-center">Aksi</th></tr>
                </thead>
                <tbody id="pList"></tbody>
            </table>
        </div>

        <div id="tab-inv" class="tab-content">
            <h2 class="text-2xl font-bold mb-6">Daftar Transaksi</h2>
            <table class="w-full text-left">
                <thead class="bg-white/5 uppercase text-xs">
                    <tr><th class="p-4">Invoice</th><th class="p-4">Item</th><th class="p-4">Status</th><th class="p-4 text-center">Aksi</th></tr>
                </thead>
                <tbody id="iList"></tbody>
            </table>
        </div>

        <div id="tab-mem" class="tab-content">
            <h2 class="text-2xl font-bold mb-6">Kelola Member</h2>
            <table class="w-full text-left">
                <thead class="bg-white/5 uppercase text-xs">
                    <tr><th class="p-4">Nama</th><th class="p-4">Saldo</th><th class="p-4 text-center">Aksi</th></tr>
                </thead>
                <tbody id="mList"></tbody>
            </table>
        </div>
    </main>

    <script>
        function tab(t) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('tab-active'));
            document.querySelectorAll('aside button').forEach(b => b.classList.remove('active-btn'));
            document.getElementById('tab-'+t).classList.add('tab-active');
            document.getElementById('b-'+t).classList.add('active-btn');
            if(t === 'prod') renderP(); if(t === 'inv') renderI(); if(t === 'mem') renderM();
        }

        // LOGIKA PRODUK
        document.getElementById('pForm').onsubmit = (e) => {
            e.preventDefault();
            let p = JSON.parse(localStorage.getItem('apip_products')) || [];
            let data = { game: document.getElementById('pGame').value, item: document.getElementById('pNama').value, price: document.getElementById('pHarga').value };
            let idx = document.getElementById('editIdx').value;
            if(idx === "") p.push(data); else p[idx] = data;
            localStorage.setItem('apip_products', JSON.stringify(p));
            document.getElementById('pForm').reset(); document.getElementById('editIdx').value = "";
            renderP();
        };

        function renderP() {
            let p = JSON.parse(localStorage.getItem('apip_products')) || [];
            document.getElementById('pList').innerHTML = p.map((x, i) => `
                <tr class="border-b border-white/5">
                    <td class="p-4 text-blue-400">${x.game}</td><td class="p-4">${x.item}</td><td class="p-4">Rp ${x.price}</td>
                    <td class="p-4 text-center">
                        <button onclick="editP(${i})" class="text-yellow-500 mr-2"><i class="fas fa-edit"></i></button>
                        <button onclick="delP(${i})" class="text-red-500"><i class="fas fa-trash"></i></button>
                    </td>
                </tr>`).join('');
        }

        function editP(i) {
            let p = JSON.parse(localStorage.getItem('apip_products'))[i];
            document.getElementById('pGame').value = p.game; document.getElementById('pNama').value = p.item;
            document.getElementById('pHarga').value = p.price; document.getElementById('editIdx').value = i;
        }

        function delP(i) { if(confirm('Hapus?')) { let p = JSON.parse(localStorage.getItem('apip_products')); p.splice(i,1); localStorage.setItem('apip_products', JSON.stringify(p)); renderP(); } }

        // LOGIKA TRANSAKSI & MEMBER (Singkat)
        function renderI() {
            let o = JSON.parse(localStorage.getItem('apip_orders')) || [];
            document.getElementById('iList').innerHTML = o.map((x, i) => `
                <tr class="border-b border-white/5">
                    <td class="p-4 font-mono">${x.id}</td><td class="p-4">${x.item}</td><td class="p-4 font-bold text-yellow-500">${x.status}</td>
                    <td class="p-4 text-center">
                        <button onclick="upS(${i}, 'Sukses')" class="text-green-500 mr-2">SUKSES</button>
                        <button onclick="upS(${i}, 'Gagal')" class="text-red-500">GAGAL</button>
                    </td>
                </tr>`).join('');
        }
        function upS(i, s) { let o = JSON.parse(localStorage.getItem('apip_orders')); o[i].status = s; localStorage.setItem('apip_orders', JSON.stringify(o)); renderI(); }

        function renderM() {
            let m = JSON.parse(localStorage.getItem('apip_members')) || [];
            document.getElementById('mList').innerHTML = m.map((x, i) => `
                <tr class="border-b border-white/5">
                    <td class="p-4">${x.name}</td><td class="p-4 text-green-400 font-bold">Rp ${x.saldo}</td>
                    <td class="p-4 text-center">
                        <button onclick="addS(${i})" class="bg-blue-600 px-3 py-1 rounded text-xs font-bold">EDIT SALDO</button>
                    </td>
                </tr>`).join('');
        }
        function addS(i) {
            let m = JSON.parse(localStorage.getItem('apip_members'));
            let s = prompt("Masukkan Saldo Baru untuk " + m[i].name, m[i].saldo);
            if(s != null) { m[i].saldo = parseInt(s); localStorage.setItem('apip_members', JSON.stringify(m)); renderM(); }
        }

        renderP();
    </script>
</body>
</html>
