<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Panel - APIP STORE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: #020617; color: white; }
        .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.05); }
        .sidebar-active { background: #3b82f6; color: white; box-shadow: 0 0 20px rgba(59, 130, 246, 0.4); }
    </style>
</head>
<body class="flex flex-col md:flex-row min-h-screen">

    <aside class="w-full md:w-64 glass p-6 border-r border-white/5 space-y-8">
        <h1 class="text-xl font-black text-center text-blue-500 uppercase tracking-tighter">Apip Panel</h1>
        <nav class="space-y-3">
            <button onclick="switchTab('produk')" id="btn-produk" class="w-full p-4 rounded-2xl flex items-center space-x-4 sidebar-active transition">
                <i class="fas fa-box text-sm"></i> <span class="text-[10px] font-bold uppercase">Produk</span>
            </button>
            <button onclick="switchTab('transaksi')" id="btn-transaksi" class="w-full p-4 rounded-2xl flex items-center space-x-4 hover:bg-white/5 transition">
                <i class="fas fa-receipt text-sm"></i> <span class="text-[10px] font-bold uppercase">Transaksi</span>
            </button>
        </nav>
    </aside>

    <main class="flex-1 p-6 md:p-12">
        <div id="tab-produk" class="tab-content space-y-6">
            <div class="glass p-6 rounded-[2rem]">
                <h2 class="text-[10px] font-black uppercase text-blue-500 mb-4">Input Produk</h2>
                <form id="formProduk" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-3">
                    <input type="hidden" id="editIndex">
                    <select id="game" class="bg-slate-900 p-4 rounded-xl text-xs border border-white/5 outline-none">
                        <option value="Mobile Legends">Mobile Legends</option>
                    </select>
                    <select id="sub" class="bg-slate-900 p-4 rounded-xl text-xs border border-white/5 outline-none text-blue-400 font-bold">
                        <option value="Diamonds ML">Diamonds ML</option>
                        <option value="Weekly Pass">Weekly Pass</option>
                    </select>
                    <input type="text" id="nama" placeholder="Nama Item" class="bg-slate-900 p-4 rounded-xl text-xs border border-white/5 outline-none" required>
                    <input type="number" id="harga" placeholder="Harga" class="bg-slate-900 p-4 rounded-xl text-xs border border-white/5 outline-none" required>
                    <button class="bg-blue-600 rounded-xl font-black text-[10px] uppercase">Simpan</button>
                </form>
            </div>
            <div class="glass rounded-[2rem] overflow-hidden">
                <table class="w-full text-left">
                    <thead class="bg-slate-900 text-[10px] uppercase text-slate-500">
                        <tr><th class="p-5">Game/Sub</th><th class="p-5">Item</th><th class="p-5">Harga</th><th class="p-5 text-center">Aksi</th></tr>
                    </thead>
                    <tbody id="listProduk" class="text-sm"></tbody>
                </table>
            </div>
        </div>

        <div id="tab-transaksi" class="tab-content hidden space-y-4">
            <div class="glass p-4 rounded-2xl flex items-center px-6">
                <i class="fas fa-search text-slate-500 mr-4"></i>
                <input type="text" id="cariInv" onkeyup="cariTabel()" placeholder="Cari No. Invoice (Contoh: API-123)..." class="bg-transparent w-full outline-none text-sm font-semibold">
            </div>
            <div class="glass rounded-[2rem] overflow-hidden">
                <table class="w-full text-left text-xs">
                    <thead class="bg-slate-900 text-[10px] uppercase text-slate-500">
                        <tr><th class="p-5">Invoice</th><th class="p-5">Detail</th><th class="p-5">Status</th><th class="p-5 text-center">Aksi</th></tr>
                    </thead>
                    <tbody id="listInv" class="divide-y divide-white/5"></tbody>
                </table>
            </div>
        </div>
    </main>

    <script>
        function switchTab(t) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.getElementById('tab-'+t).classList.remove('hidden');
            document.querySelectorAll('nav button').forEach(b => b.classList.remove('sidebar-active'));
            document.getElementById('btn-'+t).classList.add('sidebar-active');
            if(t === 'transaksi') renderInv();
        }

        const f = document.getElementById('formProduk');
        f.onsubmit = (e) => {
            e.preventDefault();
            let p = JSON.parse(localStorage.getItem('apip_products')) || [];
            let data = { game: f.game.value, sub: f.sub.value, item: f.nama.value, price: f.harga.value };
            if(f.editIndex.value === "") p.push(data); else p[f.editIndex.value] = data;
            localStorage.setItem('apip_products', JSON.stringify(p));
            f.reset(); f.editIndex.value = ""; renderProduk();
        };

        function renderProduk() {
            let p = JSON.parse(localStorage.getItem('apip_products')) || [];
            document.getElementById('listProduk').innerHTML = p.map((x,i) => `
                <tr class="border-t border-white/5 hover:bg-white/5">
                    <td class="p-5"><b>${x.game}</b><br><small class="text-blue-500 font-bold uppercase text-[9px]">${x.sub}</small></td>
                    <td class="p-5 font-semibold">${x.item}</td>
                    <td class="p-5 text-green-400 font-bold">Rp ${Number(x.price).toLocaleString()}</td>
                    <td class="p-5 text-center">
                        <button onclick="editP(${i})" class="text-blue-400 mr-3"><i class="fas fa-edit"></i></button>
                        <button onclick="hapusP(${i})" class="text-red-500"><i class="fas fa-trash"></i></button>
                    </td>
                </tr>`).join('');
        }

        function renderInv() {
            let o = JSON.parse(localStorage.getItem('apip_orders')) || [];
            document.getElementById('listInv').innerHTML = o.slice().reverse().map((x,i) => {
                let realI = o.length - 1 - i;
                return `<tr class="inv-row hover:bg-white/5" data-id="${x.id.toUpperCase()}">
                    <td class="p-5"><b class="text-blue-400 font-mono text-sm">${x.id}</b><br><small class="text-slate-500">${x.date}</small></td>
                    <td class="p-5"><b>${x.target}</b><br><span class="text-xs text-slate-400">${x.item}</span></td>
                    <td class="p-5"><select onchange="upStat(${realI},this.value)" class="bg-slate-900 border border-white/10 rounded p-1 text-[10px] outline-none">
                        <option ${x.status=='Pending'?'selected':''}>Pending</option>
                        <option ${x.status=='Sukses'?'selected':''}>Sukses</option>
                        <option ${x.status=='Gagal'?'selected':''}>Gagal</option>
                    </select></td>
                    <td class="p-5 text-center"><button onclick="hapusI(${realI})" class="text-red-500"><i class="fas fa-trash text-xs"></i></button></td>
                </tr>`}).join('');
        }

        function editP(i) {
            let p = JSON.parse(localStorage.getItem('apip_products'))[i];
            f.game.value = p.game; f.sub.value = p.sub; f.nama.value = p.item; f.harga.value = p.price; f.editIndex.value = i;
            window.scrollTo(0,0);
        }

        function hapusP(i) { if(confirm('Hapus Item?')) { let p = JSON.parse(localStorage.getItem('apip_products')); p.splice(i,1); localStorage.setItem('apip_products', JSON.stringify(p)); renderProduk(); } }
        function hapusI(i) { if(confirm('Hapus Transaksi?')) { let o = JSON.parse(localStorage.getItem('apip_orders')); o.splice(i,1); localStorage.setItem('apip_orders', JSON.stringify(o)); renderInv(); } }
        function upStat(i,s) { let o = JSON.parse(localStorage.getItem('apip_orders')); o[i].status = s; localStorage.setItem('apip_orders', JSON.stringify(o)); renderInv(); }
        function cariTabel() {
            let v = document.getElementById('cariInv').value.toUpperCase();
            document.querySelectorAll('.inv-row').forEach(r => r.style.display = r.dataset.id.includes(v) ? '' : 'none');
        }

        renderProduk();
    </script>
</body>
</html>